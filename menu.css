/* ================================================= */
/* ===== VARIABLES Y ESTILOS BASE (TEMA CLARO) ===== */
/* ================================================= */
:root{
  --bg:#f4f7fa;
  --panel:#ffffff;
  --fg:#2d3748;
  --muted:#718096;
  --border:#e2e8f0;
  --brand:#3b82f6;
  --brand2:#60a5fa;
  --accent:#3b82f6;
  --ok:#22c55e;
  --warn:#f59e0b;
  --err:#ef4444;

  --sideW:260px;
  --sideW-collapsed:82px;
  --rad:12px;
  --shadow:0 4px 6px -1px rgba(0,0,0,.05), 0 2px 4px -1px rgba(0,0,0,.04);

  /* Alturas unificadas para KPI */
  --kpi-h-small:260px;  /* líneas / donut */
  --kpi-h-bar:260px;    /* barras */
  --kpi-h-table:260px;  /* tablas/heatmaps */
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--fg); background:var(--bg);
  font:15px/1.45 system-ui, Segoe UI, Roboto, Ubuntu, 'Helvetica Neue', Arial;
  overflow:hidden;
  animation: fadeInScale 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  opacity: 0;
}
body::before{display:none}

/* ================================================= */
/* ===== LAYOUT PRINCIPAL (APP, SIDEBAR, MAIN) ===== */
/* ================================================= */
.app{display:flex; height:100vh}

.sidebar{
  display:flex; flex-direction:column; gap:14px; padding:16px;
  width:var(--sideW); height:100%; z-index:100;
  background:linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%);
  border-right:1px solid var(--border);
  transition:width .25s ease, transform .3s ease;
  box-shadow: 2px 0 8px rgba(0,0,0,0.04);
  overflow-y:auto;
  animation: slideInLeft 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) 0.1s both;
}
.sidebar::-webkit-scrollbar{width:6px}
.sidebar::-webkit-scrollbar-track{background:transparent}
.sidebar::-webkit-scrollbar-thumb{background:rgba(59,130,246,0.3); border-radius:3px}
.sidebar::-webkit-scrollbar-thumb:hover{background:rgba(59,130,246,0.6)}

.sidebar.collapsed{width:var(--sideW-collapsed)}
.sidebar.collapsed .brand-text,
.sidebar.collapsed .nav-item span,
.sidebar.collapsed .logout{display:none}
.sidebar.collapsed .nav .nav-item{justify-content:center}
.sidebar.collapsed .brand{padding:10px; gap:0}

.brand{
  display:flex; align-items:center; gap:10px; justify-content:flex-start;
  padding:14px 16px; border:2px solid rgba(59,130,246,0.15);
  border-radius:14px; background:linear-gradient(135deg, rgba(59,130,246,0.05), rgba(102,126,234,0.05));
  font-weight:800; transition: all 0.3s ease; position:relative;
}
.brand:hover{
  border-color:rgba(59,130,246,0.3);
  background:linear-gradient(135deg, rgba(59,130,246,0.1), rgba(102,126,234,0.1));
}
.brand::before{
  content:'';
  position:absolute;
  top:0;
  left:0;
  right:0;
  height:2px;
  background:linear-gradient(90deg, var(--brand), var(--brand2), transparent);
  border-radius:14px 14px 0 0;
  opacity:0;
  transition:opacity 0.3s ease;
}
.brand:hover::before{opacity:1}

.logo{
  min-width:32px; height:32px; border-radius:50%;
  background:linear-gradient(135deg, var(--brand), var(--brand2));
  box-shadow:0 0 20px rgba(59,130,246,.5), 0 0 40px rgba(59,130,246,.2);
  flex-shrink: 0;
  animation: pulse-glow 3s ease-in-out infinite;
}
@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 20px rgba(59,130,246,.5), 0 0 40px rgba(59,130,246,.2); }
  50% { box-shadow: 0 0 30px rgba(59,130,246,.8), 0 0 60px rgba(59,130,246,.4); }
}

/* ===== BOTÓN HAMBURGUESA MODERNO ===== */
.burger{
  width:48px; height:48px; border:none;
  border-radius:12px; 
  background:linear-gradient(135deg, rgba(59,130,246,0.08), rgba(102,126,234,0.04));
  display:grid; place-items:center; cursor:pointer; padding:0; 
  flex-shrink: 0; transition:all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
  position:relative; overflow:hidden;
  box-shadow:0 2px 8px rgba(59,130,246,0.1);
}

.burger::before{
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 50% 50%, rgba(255,255,255,0.3), transparent);
  opacity:0;
  transition:opacity 0.35s ease;
}

.burger:hover{
  border-color:transparent;
  background:linear-gradient(135deg, rgba(59,130,246,0.15), rgba(102,126,234,0.1));
  transform:scale(1.08) translateY(-1px);
  box-shadow:0 6px 16px rgba(59,130,246,0.25);
}

.burger:hover::before{
  opacity:1;
}

.burger:active{
  transform:scale(0.95);
}

.burger span{
  display:block; 
  width:20px; height:2.5px; 
  background:var(--fg); 
  border-radius:1.25px; 
  transition:all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
  position:relative;
  box-shadow:0 1px 2px rgba(0,0,0,0.1);
}

.burger span:nth-child(1){ transform:translateY(-6px); }
.burger span:nth-child(2){ opacity:1; }
.burger span:nth-child(3){ transform:translateY(6px); }

.burger:hover span{
  background:var(--brand);
}

.burger.active span:nth-child(1){
  transform:translateY(0) rotate(45deg);
  background:var(--brand);
}

.burger.active span:nth-child(2){
  opacity:0;
}

.burger.active span:nth-child(3){
  transform:translateY(0) rotate(-45deg);
  background:var(--brand);
}

.nav{display:flex; flex-direction:column; gap:8px; margin-top:8px}
.nav-item{
  appearance:none; border:1px solid transparent; background:transparent;
  color:var(--muted); padding:12px 14px; border-radius:12px; text-align:left;
  display:flex; align-items:center; gap:12px; font-weight:600; cursor:pointer; 
  white-space:nowrap; transition:all 0.3s ease; position:relative;
}
.nav-item:hover{
  background:linear-gradient(135deg, rgba(59,130,246,0.1), rgba(102,126,234,0.05));
  color:var(--fg);
  border-color:rgba(59,130,246,0.2);
  transform:translateX(4px);
}
.nav-item.active{
  background:linear-gradient(135deg, rgba(59,130,246,0.15), rgba(102,126,234,0.1));
  color:var(--brand);
  border-left:4px solid var(--brand);
  padding-left:10px;
  font-weight:700;
  box-shadow:0 2px 8px rgba(59,130,246,0.15);
}
.nav-item.active::before{
  content:'';
  position:absolute;
  left:0;
  top:0;
  height:100%;
  width:4px;
  background:linear-gradient(180deg, var(--brand), var(--brand2));
  border-radius:0 4px 4px 0;
}
.nav-group{
  display:flex;
  flex-direction:column;
  gap:6px;
  margin-top:12px;
  padding:12px 0;
  border-top:2px solid var(--border);
}
.nav-group:first-of-type{
  margin-top:0;
  border-top:none;
}

.nav-group-toggle{
  position:relative;
  appearance:none;
  border:none;
  background:linear-gradient(135deg, rgba(59,130,246,0.08), rgba(102,126,234,0.08));
  color:var(--fg);
  padding:12px 14px;
  border-radius:12px;
  text-align:left;
  display:flex;
  align-items:center;
  gap:12px;
  font-weight:700;
  cursor:pointer;
  white-space:nowrap;
  font-size:14px;
  transition:all 0.3s ease;
  border:2px solid rgba(59,130,246,0.2);
}

.nav-group-toggle:hover{
  background:linear-gradient(135deg, rgba(59,130,246,0.15), rgba(102,126,234,0.15));
  border-color:rgba(59,130,246,0.5);
  transform:translateX(3px);
  box-shadow:0 2px 6px rgba(59,130,246,0.1);
}

.nav-group-toggle[aria-expanded="true"]{
  background:linear-gradient(135deg, rgba(59,130,246,0.2), rgba(102,126,234,0.15));
  border-color:var(--brand);
  color:var(--brand);
  box-shadow:0 4px 12px rgba(59,130,246,0.2);
}

.icon-chevron{
  width:20px;
  height:20px;
  margin-left:auto;
  transition:transform 0.3s ease;
  stroke-width:2.5;
  flex-shrink:0;
}

.nav-group-toggle[aria-expanded="true"] .icon-chevron{
  transform:rotate(180deg);
  color:var(--brand);
}

.nav-group-menu{
  display:none;
  flex-direction:column;
  gap:6px;
  margin-top:6px;
  margin-left:0;
  padding:8px 12px;
  border-left:4px solid var(--brand);
  background:linear-gradient(135deg, rgba(59,130,246,0.04), rgba(102,126,234,0.02));
  border-radius:0 8px 8px 0;
  animation:slideDown 0.3s ease;
}

.nav-group-menu .nav-item{
  padding:10px 12px;
  font-size:13px;
  color:#718096;
  border-left:3px solid transparent;
  padding-left:9px;
}
.nav-group-menu .nav-item:hover{
  color:var(--fg);
  background:rgba(59,130,246,0.08);
  border-left-color:var(--brand);
  padding-left:9px;
}
.nav-group-menu .nav-item.active{
  color:var(--brand);
  background:rgba(59,130,246,0.12);
  border-left:3px solid var(--brand);
  padding-left:9px;
  font-weight:600;
}

@keyframes slideDown {
  from {
    opacity:0;
    transform:translateY(-8px);
  }
  to {
    opacity:1;
    transform:translateY(0);
  }
}

/* ===== Animaciones de entrada tipo Figma ===== */
@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(60px);
    filter: blur(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }
}

@keyframes slideInLeft {
  from {
    opacity: 0;
    transform: translateX(-80px);
    filter: blur(8px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
    filter: blur(0);
  }
}

@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.95);
    filter: blur(4px);
  }
  to {
    opacity: 1;
    transform: scale(1);
    filter: blur(0);
  }
}

.nav-group-toggle[aria-expanded="true"] ~ .nav-group-menu{
  display:flex;
}

.nav-subitem{
  appearance:none;
  border:1px solid transparent;
  background:rgba(59,130,246,0.05);
  color:var(--muted);
  padding:10px 12px;
  border-radius:8px;
  text-align:left;
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:600;
  cursor:pointer;
  white-space:nowrap;
  font-size:13px;
  transition:all 0.2s ease;
}

.nav-subitem:hover{
  background:rgba(59,130,246,0.15);
  color:var(--brand);
  transform:translateX(4px);
  border-color:rgba(59,130,246,0.3);
}

.nav-subitem.active{
  background:rgba(59,130,246,0.2);
  color:var(--brand);
  border-color:var(--brand);
  font-weight:700;
}

.icon{
  width:20px;
  height:20px;
  stroke-width:2;
  flex-shrink:0;
  transition:all 0.3s ease;
}
.nav-item:hover .icon{
  color:var(--brand);
}

.spacer{flex:1}

.logout{
  appearance:none; width:100%; border-radius:12px; padding:12px 14px;
  border:2px solid rgba(239,68,68,.3); background:linear-gradient(135deg, rgba(239,68,68,.05), rgba(244,68,54,.03));
  color:#c53030; font-weight:700; cursor:pointer; text-align:center;
  font-size:14px; transition:all 0.3s ease; display:flex; align-items:center;
  justify-content:center; gap:8px;
}
.logout:hover{
  background:linear-gradient(135deg, rgba(239,68,68,.12), rgba(244,68,54,.08));
  border-color:rgba(239,68,68,.5);
  transform:translateY(-2px);
  box-shadow:0 4px 12px rgba(239,68,68,.2);
  color:#a71f1f;
}
.logout:active{
  transform:translateY(0);
  box-shadow:0 2px 6px rgba(239,68,68,.1);
}

.main{flex:1; display:flex; flex-direction:column; gap:12px; padding:14px; overflow:hidden; animation: slideInUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) 0.2s both}
.topbar{
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 14px; border-radius:var(--rad); background:var(--panel);
  border:1px solid var(--border); box-shadow:var(--shadow);
  animation: fadeInScale 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) 0.3s both;
}
.title{font-weight:800; letter-spacing:.2px; margin:0}

/* ===== TOPBAR RIGHT (Logo + User) ===== */
.topbar-right {
  display: flex;
  align-items: center;
  gap: 16px;
}

/* ===== LOGO EMPRESA EN TOPBAR ===== */
.logo-empresa-topbar {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 40px;
  padding: 4px 12px;
  border-radius: 10px;
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(102, 126, 234, 0.04));
  border: 1px solid rgba(59, 130, 246, 0.1);
  transition: all 0.3s ease;
}

.logo-empresa-topbar:hover {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(102, 126, 234, 0.1));
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
  transform: translateY(-2px);
}

.logo-empresa-img-topbar {
  height: 32px;
  width: auto;
  max-width: 100px;
  object-fit: contain;
  object-position: center;
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.05));
}

.userpill{
  display:flex; align-items:center; gap:10px; padding:8px 12px;
  border-radius:999px; background:var(--bg); border:1px solid var(--border);
}
.avatar{
  width:28px; height:28px; border-radius:50%;
  background:linear-gradient(135deg, var(--brand), var(--brand2));
  display:grid; place-items:center; font-weight:800; color:white;
}
.muted{color:var(--muted)}

.views{flex:1; overflow:auto; position:relative}
.view{display:none; height:100%; width:100%}
.view.shown{display:block}

.page{
  background:var(--panel); border:1px solid var(--border);
  border-radius:var(--rad); box-shadow:var(--shadow); padding:20px;
}
.page-head{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:12px; flex-wrap:wrap; gap:10px;
}
.page h2{margin:0}
.menu-toggle{
  display:none; background:transparent; border:none; cursor:pointer; padding:8px 12px; 
  border-radius:12px; transition:all .3s ease; position:relative;
  color:var(--primary); width:40px; height:40px; display:flex;
  align-items:center; justify-content:center;
}
.menu-toggle:hover{
  background:rgba(59, 130, 246, 0.1); transform:scale(1.05);
}
.menu-toggle:active{transform:scale(0.95)}
.menu-toggle svg{width:24px; height:24px; transition:transform .3s ease}
.menu-toggle[aria-expanded="true"] svg{transform:rotate(90deg)}
.menu-overlay{
  position:fixed; inset:0; z-index:99; background:rgba(0,0,0,.5);
  opacity:0; visibility:hidden; transition:opacity .3s ease, visibility .3s ease;
}
.menu-overlay.show{opacity:1; visibility:visible}

/* ================================================= */
/* ===== COMPONENTES GENÉRICOS ===== */
/* ================================================= */
.table-wrap{overflow:auto}
.data-table{
  width:100%; border-collapse:separate; border-spacing:0; min-width:760px;
  border:1px solid var(--border); border-radius:12px; overflow:hidden;
}
.data-table thead th{
  text-align:left; padding:12px; font-size:13px; color:var(--muted);
  background:var(--bg); border-bottom:1px solid var(--border);
}
.data-table tbody td{padding:12px; border-bottom:1px solid var(--border)}
.data-table tbody tr:hover{background-color:var(--bg)}
.row-actions{display:flex; gap:8px}

.search-bar{position:relative; margin-bottom:16px}
.search-bar input{width:100%; padding:10px 12px}

.btn{
  appearance:none; border:0; cursor:pointer; border-radius:10px;
  padding:8px 12px; font-weight:800; background:var(--brand); color:white;
  box-shadow:0 4px 14px rgba(59,130,246,.25);
}
.btn.small{padding:6px 10px; font-weight:700; border-radius:8px}
.btn.secondary{background:var(--bg); color:var(--fg); border:1px solid var(--border); box-shadow:none}
.btn.danger{background:rgba(239,68,68,.18); color:#c53030; border:1px solid rgba(239,68,68,.35); box-shadow:none}

/* ================================================= */
/* ===== OVERLAYS, MODALES Y DIÁLOGOS ===== */
/* ================================================= */
.overlay{
  position:fixed; inset:0; z-index:60; display:none; place-items:center;
  background:rgba(8,12,22,.65); backdrop-filter:blur(10px) saturate(140%);
  transition:opacity .25s ease; opacity:0;
}
.overlay.show{display:grid; opacity:1}
.ol-card{
  width:min(520px, 92vw); padding:22px 20px 18px; border-radius:18px;
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
  box-shadow:0 30px 100px rgba(0,0,0,.45); text-align:center; color:white;
}
.ol-title{color:white}
.ol-sub{color:#e2e8f0}
.ol-anim{position:relative; width:84px; height:84px; margin:6px auto 14px; filter:drop-shadow(0 10px 24px rgba(167,139,250,.25))}
.ol-anim .ring{position:absolute; inset:0; border-radius:50%; border:4px solid rgba(255,255,255,.18)}
.ol-anim .ring.one{border-top-color:transparent; animation:spin 1.1s linear infinite}
.ol-anim .ring.two{inset:6px; border-left-color:transparent; animation:spin 1.6s linear infinite reverse}
@keyframes spin{to{transform:rotate(360deg)}}

.modal{
  position:fixed; inset:0; display:none; place-items:center;
  background:rgba(10,13,23,.6); backdrop-filter:blur(6px); z-index:40;
}
.modal.show{display:grid}
.modal-box{
  width:min(720px, 92vw); background:var(--panel); border:1px solid var(--border);
  border-radius:16px; padding:18px; box-shadow:var(--shadow);
}
.grid-2{display:grid; grid-template-columns:1fr 1fr; gap:12px}
label{display:flex; flex-direction:column; gap:6px; font-size:14px}
input,select{
  background:var(--bg); border:1px solid var(--border); color:var(--fg);
  border-radius:10px; padding:10px 12px; outline:none; font:inherit; width:100%;
}
input:focus,select:focus{border-color:var(--brand)}
.modal-actions{display:flex; justify-content:flex-end; gap:10px; margin-top:14px}

.dialog{
  position:fixed; inset:0; z-index:50; display:none; place-items:center;
  background:rgba(10,13,23,.6); backdrop-filter:blur(6px);
}
.dialog.show{display:grid}
.dialog-box{
  width:min(520px, 92vw); background:var(--panel); border:1px solid var(--border);
  border-radius:16px; padding:20px; box-shadow:var(--shadow); text-align:center;
}
.dialog-icon{
  margin:0 auto 10px; width:52px; height:52px; border-radius:50%;
  display:grid; place-items:center; font-size:24px; font-weight:900; color:white; background:var(--brand);
}
.dialog-actions{display:flex; justify-content:center; gap:10px; margin-top:16px}

.toast{
  position:fixed; left:50%; bottom:26px; transform:translateX(-50%) translateY(120%);
  background:#2d3748; color:white; border:1px solid var(--border); border-radius:12px;
  padding:10px 14px; box-shadow:var(--shadow); z-index:60; opacity:0; transition:all .28s ease;
}
.toast.show{transform:translateX(-50%) translateY(0); opacity:1}

/* ================================================= */
/* ===== ESTILOS PARA CUADERNO ===== */
/* ================================================= */
.filter-bar{
  display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
  align-items:flex-end; gap:16px; margin-bottom:20px; padding:16px;
  background:var(--panel); border:1px solid var(--border); border-radius:12px;
}
.filter-bar label{display:flex; flex-direction:column; gap:6px; font-size:14px}
.filter-bar .btn{height:40px}

/* ================================================= */
/* ===== ESTILOS PARA LIBRERÍA CHOICES.JS ===== */
/* ================================================= */
.choices__inner{
  background-color:var(--panel) !important;
  border:1px solid var(--border) !important;
  color:var(--fg) !important;
  border-radius:10px; min-height:40px; font-size:15px; padding:4px 10px !important;
}
.choices__list--dropdown{
  background:var(--panel) !important; border:1px solid var(--border) !important;
  border-radius:10px; z-index:5; min-width:180px;
}
.choices__item--choice{
  color:var(--muted); font-size:14px; padding:8px 12px !important;
  white-space:nowrap; display:flex !important; justify-content:space-between; align-items:center;
}
.choices__item--selectable.is-highlighted{background-color:var(--bg) !important; color:var(--fg) !important}
.choices__list--single.is-placeholder .choices__item{color:var(--muted)}
.choices__item--choice::after{
  content:'Seleccionar'; color:var(--brand); font-weight:600; margin-left:auto; padding-left:16px;
  opacity:0; transition:opacity .2s ease;
}
.choices__item--choice.is-highlighted::after{opacity:1}
.kpi-actions .choices__inner{min-height:auto; padding:6px 10px !important; font-size:14px; min-width:120px}

/* ================================================= */
/* ===== ESTILOS ESPECÍFICOS PARA KPI ===== */
/* ================================================= */
#view-kpi{flex-direction:column; gap:16px; height:100%}

.kpi-subnav{
  display:flex; flex-wrap:wrap; gap:8px;
  padding-bottom:12px; border-bottom:1px solid var(--border); flex-shrink:0;
}
.kpi-subnav-btn{
  appearance:none; background:transparent; border:1px solid transparent;
  color:var(--muted); font-size:14px; font-weight:600; padding:8px 16px; border-radius:8px;
  cursor:pointer; transition:all .2s ease;
}
.kpi-subnav-btn:hover{background-color:var(--bg); color:var(--fg)}
.kpi-subnav-btn.active{color:var(--brand); background-color:rgba(59,130,246,.1)}

.kpi-subviews-container{flex-grow:1; overflow:auto; position:relative; display:flex; flex-direction:column}
.kpi-subview{display:none; width:100%; padding:0}
.kpi-subview.active{display:flex; flex-direction:column; width:100%}

.placeholder-page{
  display:flex; flex-direction:column; justify-content:center; align-items:center;
  height:100%; min-height:50vh; background:var(--panel); border:1px dashed var(--border);
  border-radius:var(--rad); text-align:center; padding:20px;
}
.placeholder-page h3{font-size:1.5rem; margin-bottom:8px; color:var(--fg)}

/* --- Pestaña RESUMEN --- */
#kpi-resumen.active{display:flex; flex-direction:column; gap:16px}
#kpi-resumen.active .resumen-filters{flex-shrink:0}
#kpi-resumen.active .resumen-grid{width:100%; display:grid}

.resumen-filters{
  display:flex; gap:1.5rem; padding:1rem 1.25rem; margin-bottom:0;
  background:#fff; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1);
  align-items:flex-end; flex-shrink:0; flex-wrap:wrap;
}
.resumen-filters .filters-wrapper{
  display:flex; gap:1.2rem; flex:1; align-items:flex-end; flex-wrap:nowrap;
}
.resumen-filters .filter-item{
  display:flex; flex-direction:column; gap:0.3rem; flex-shrink:0;
}
.resumen-filters .filter-item.filter-date-range{
  flex-direction:row; align-items:flex-end; gap:0.5rem;
  flex-shrink:1; min-width:auto; flex-wrap:wrap;
}
.resumen-filters .filter-label{
  font-size:0.65rem; color:#666; font-weight:600; text-transform:uppercase; letter-spacing:0.4px;
}
.resumen-filters .filter-item.filter-date-range .filter-label{
  flex-basis:100%; order:-1; margin-bottom:0.3rem;
}
.resumen-filters .filter-item select,
.resumen-filters .filter-item input{
  padding:0.4rem 0.6rem; border:1px solid #e2e8f0; border-radius:6px;
  font-size:0.8rem; color:#1a202c; background-color:#f8fafc;
  transition:all 0.2s; height:32px; width:140px; font-family:inherit;
}
.resumen-filters .filter-item.filter-date-range input{
  width:220px;
}
.resumen-filters .filter-item select:hover,
.resumen-filters .filter-item input:hover{border-color:#cbd5e0; background-color:#fff}
.resumen-filters .filter-item select:focus,
.resumen-filters .filter-item input:focus{
  border-color:#4287f5; background-color:#fff; outline:none;
  box-shadow:0 0 0 3px rgba(66,135,245,0.15);
}
.resumen-filters .total-mini{
  background:linear-gradient(135deg, #4287f5, #3b7be0); color:white;
  padding:0.8rem 1.5rem; border-radius:8px; text-align:center; min-width:180px;
  box-shadow:0 4px 15px rgba(66,135,245,0.2); position:relative; overflow:hidden;
  transition:transform 0.2s, box-shadow 0.2s; cursor:default;
}
.resumen-filters .total-mini::before{
  content:''; position:absolute; inset:0;
  background:linear-gradient(45deg, transparent, rgba(255,255,255,0.1)); pointer-events:none;
}
.resumen-filters .total-mini:hover{
  transform:translateY(-2px); box-shadow:0 6px 20px rgba(66,135,245,0.25);
}
.resumen-filters .total-mini__num{
  font-size:2rem; font-weight:700; line-height:1; margin-bottom:0.3rem;
  text-shadow:0 2px 4px rgba(0,0,0,0.1);
}
.resumen-filters .total-mini__label{
  font-size:0.7rem; font-weight:600; letter-spacing:0.4px; text-transform:uppercase;
  opacity:0.95; text-shadow:0 1px 2px rgba(0,0,0,0.1);
}

/* GRID del RESUMEN */
.resumen-grid{
  display:grid; grid-template-columns:repeat(3, 1fr);
  grid-template-rows:300px 300px 600px; gap:1rem; padding:0;
  width:100%;
}
.resumen-grid::-webkit-scrollbar{
  width:10px; height:10px;
}
.resumen-grid::-webkit-scrollbar-track{
  background:#f4f7fa;
}
.resumen-grid::-webkit-scrollbar-thumb{
  background:#cbd5e0; border-radius:5px;
}
.resumen-grid::-webkit-scrollbar-thumb:hover{
  background:#a0aec0;
}
.kpi-card, .chart-card{
  background:#fff; border-radius:8px; padding:0.75rem;
  box-shadow:0 1px 3px rgba(0,0,0,0.1); display:flex; flex-direction:column;
  overflow:hidden;
}
.kpi-card h4, .chart-title{
  font-size:0.9rem; font-weight:600; color:#333; margin:0 0 0.5rem 0;
  flex-shrink:0;
}
.chart-container{position:relative; height:100%; width:100%}
.category-chart{height:400px}
.category-chart .chart-container{height:calc(100% - 2rem)}

/* Alturas y espaciado */
.resumen-grid .kpi-card{height:100%; display:flex; flex-direction:column; min-height:0}
.resumen-grid .kpi-card canvas{flex:1; position:relative; min-height:0}

/* ===== GRID POSITIONING ===== */
.card-riesgo{grid-column:1; grid-row:1}
.card-categoria{grid-column:2; grid-row:1}
.card-mes{grid-column:3; grid-row:1}
.card-unidad{grid-column:1/3; grid-row:2}
.card-fecha{grid-column:3; grid-row:2}
.card-heatmap{grid-column:1/3; grid-row:3; min-height:1200px}
.card-sedes{grid-column:3; grid-row:3; min-height:600px}

/* Estilos específicos del HEATMAP */
.heatmap-card{
  overflow:hidden; display:flex; flex-direction:column;
  background:#fff; padding:0; height:100%;
}
.heatmap-card h4{
  margin:0 0 0 0; padding:0.75rem; font-size:0.9rem; flex-shrink:0;
  font-weight:600; color:#fff;
  background:linear-gradient(135deg, #0ea5e9, #06b6d4);
  border-radius:8px 8px 0 0;
}
.heatmap-card .table-wrap{
  flex:1 1 auto;
  background:#fff;
  width:100%;
  min-height:0;
  overflow:auto;
}
.heatmap-card .table-wrap::-webkit-scrollbar{
  width:8px; height:8px;
}
.heatmap-card .table-wrap::-webkit-scrollbar-track{
  background:#f0f9ff;
}
.heatmap-card .table-wrap::-webkit-scrollbar-thumb{
  background:#cbd5e0; border-radius:4px;
}
.heatmap-card .table-wrap::-webkit-scrollbar-thumb:hover{
  background:#94a3b8;
}
.heatmap-card table{
  font-size:0.7rem; width:100%; border-collapse:collapse;
  background:#fff;
}
.heatmap-card table th,
.heatmap-card table td{
  padding:0.35rem 0.3rem; text-align:center; white-space:nowrap;
  border-right:1px solid #e0e7ff;
  border-bottom:1px solid #e0e7ff;
}
.heatmap-card table td:last-child,
.heatmap-card table th:last-child{
  border-right:none;
}
.heatmap-card table thead th{
  background:#0ea5e9; color:white; font-weight:600;
  position:sticky; top:0; z-index:10; padding:0.6rem 0.4rem;
  font-size:0.68rem;
}
.heatmap-card table tbody tr:hover{background:#f0f9ff}
.heatmap-card table tbody tr:hover td{background:inherit}
.heatmap-card table tbody td:first-child{
  font-weight:600; color:#0ea5e9; text-align:center;
  background:#f8fafc; position:sticky; left:0; z-index:5;
  font-size:0.68rem;
}
.heatmap-card table tfoot th{
  background:#f0f9ff; color:#0c4a6e; font-weight:600;
  position:sticky; bottom:0; z-index:10; padding:0.6rem 0.4rem;
  font-size:0.68rem;
}
.map-card{
  background:#f8fafc; overflow:auto; display:flex; flex-direction:column;
  scrollbar-width:thin;
  scrollbar-color:#cbd5e0 #f8fafc;
}
.map-card::-webkit-scrollbar{
  width:10px; height:10px;
}
.map-card::-webkit-scrollbar-track{
  background:#f8fafc;
}
.map-card::-webkit-scrollbar-thumb{
  background:#cbd5e0; border-radius:5px;
}
.map-card::-webkit-scrollbar-thumb:hover{
  background:#a0aec0;
}

/* =========================
   RESPONSIVE (1400px - Tablet)
   ========================= */
@media (max-width:1400px){
  .resumen-grid{
    grid-template-columns:repeat(2, 1fr); grid-template-rows:auto auto auto auto auto; height:auto;
  }
  .card-riesgo{grid-column:1; grid-row:1}
  .card-categoria{grid-column:2; grid-row:1}
  .card-heatmap{grid-column:1/3; grid-row:2}
  .card-unidad{grid-column:1/3; grid-row:3}
  .card-fecha{grid-column:1/3; grid-row:4}
  .card-mes{grid-column:1/3; grid-row:5}
  .card-sedes{grid-column:1/3; grid-row:6; height:400px}
  .resumen-grid .kpi-card{min-height:270px; height:auto}
}

/* =========================
   RESPONSIVE (1200px - Tablet)
   ========================= */
@media (max-width:1200px){
  .resumen-grid{grid-template-columns:repeat(2, 1fr); gap:0.9rem}
  .card-riesgo{grid-column:1; grid-row:1}
  .card-categoria{grid-column:2; grid-row:1}
  .card-heatmap{grid-column:1/3; grid-row:2}
  .card-unidad{grid-column:1/3; grid-row:3}
  .card-fecha{grid-column:1; grid-row:4}
  .card-mes{grid-column:2; grid-row:4}
  .card-sedes{grid-column:1/3; grid-row:5; min-height:400px}
  .resumen-grid .kpi-card{min-height:260px}
}

/* =========================
   RESPONSIVE (768px - Mobile)
   ========================= */
@media (max-width:768px){
  .resumen-grid{grid-template-columns:1fr; gap:0.8rem; padding:0; height:auto}
  .resumen-filters{flex-direction:column; align-items:stretch; gap:0.8rem}
  .resumen-filters .filter-item select,
  .resumen-filters .filter-item input{width:100%}
  .card-riesgo, .card-categoria, .card-heatmap, .card-unidad, .card-sedes, .card-fecha, .card-mes{
    grid-column:1; grid-row:auto; height:auto; min-height:250px;
  }
  .card-sedes{min-height:300px}
  .resumen-grid .kpi-card{min-height:250px}
}

/* ===== Estilos mejorados para gráficos ===== */
.kpi-card h4{
  font-size:1rem; font-weight:600; color:#2d3748; margin:0 0 1rem 0; letter-spacing:0.3px;
}
.kpi-card canvas{width:100% !important; height:auto !important}
.kpi-card > div:last-child{flex:1; display:flex; align-items:center; justify-content:center; position:relative}

/* Table wrap responsivo */
.table-wrap{width:100%; overflow-x:auto; flex:1; display:flex; flex-direction:column}
.table-wrap table{width:100%; border-collapse:collapse; font-size:0.85rem}
.table-wrap table thead{background:#f7fafc; border-bottom:2px solid #e2e8f0; font-weight:600; color:#2d3748}
.table-wrap table th{padding:0.75rem; text-align:left}
.table-wrap table td{padding:0.75rem; border-bottom:1px solid #edf2f7}
.table-wrap table tbody tr:hover{background:#f9fafb}

/* Mapa de Sedes */
#resumen-map{
  width:100%; height:100%; border-radius:8px; overflow:auto;
  box-shadow:inset 0 2px 8px rgba(0,0,0,0.1);
  min-height:500px;
  scrollbar-width:thin;
  scrollbar-color:#cbd5e0 #f0f4f8;
}
#resumen-map::-webkit-scrollbar{
  width:10px; height:10px;
}
#resumen-map::-webkit-scrollbar-track{
  background:#f0f4f8;
}
#resumen-map::-webkit-scrollbar-thumb{
  background:#cbd5e0; border-radius:5px;
}
#resumen-map::-webkit-scrollbar-thumb:hover{
  background:#a0aec0;
}
#resumen-map .leaflet-container{width:100%; height:100%; font-family:inherit}
#resumen-map .leaflet-control-attribution{font-size:11px; padding:4px 8px}
#resumen-map .custom-marker{filter:drop-shadow(0 2px 4px rgba(0,0,0,0.2))}
#resumen-map .leaflet-popup-content{font-size:13px; line-height:1.6}
#resumen-map .leaflet-popup-content strong{color:var(--brand); display:block; margin-bottom:4px}

/* Card especial del mapa con altura mayor */
.card-sedes #resumen-map{
  height:100%; min-height:500px;
}

/* --- Pestaña DETALLE DE INCIDENTES --- */
#kpi-detalle-incidentes .page-head{display:flex; justify-content:space-between; align-items:center; margin-bottom:16px}
.kpi-layout{display:grid; grid-template-columns:1fr 280px; gap:16px; height:calc(100% - 60px)}
.kpi-main{display:grid; grid-template-rows:auto 1fr; gap:16px; overflow:hidden}
.kpi-sidebar{display:flex; flex-direction:column; gap:16px; overflow-y:auto}
.kpi-actions{display:flex; align-items:center; gap:10px; flex-wrap:wrap}
.kpi-actions label{display:flex; align-items:center; gap:6px}

.stat{
  background:var(--panel); border:1px solid var(--border); border-radius:var(--rad);
  padding:16px; display:flex; flex-direction:column; align-items:flex-start; gap:4px;
  border-left:4px solid var(--card-color); box-shadow:var(--shadow);
}
.stat-value{font-size:2rem; font-weight:700; line-height:1.1}
.stat-label{font-size:.8rem; color:var(--muted)}

.kpi-chart-wrapper{
  position:relative; background:var(--panel); border:1px solid var(--border);
  border-radius:var(--rad); padding:16px; height:280px; flex-shrink:0;
}
.kpi-tables-wrapper{display:grid; grid-template-columns:1fr 1fr; gap:16px; overflow:auto}
.kpi-table-item{
  background:var(--panel); border:1px solid var(--border); border-radius:var(--rad);
  padding:16px; display:flex; flex-direction:column; min-width:0;
}
.kpi-table-item h3{margin:0 0 10px 0; font-size:1rem}
.kpi-table-item .table-wrap{overflow:auto}
.kpi-table-item table{width:100%; border-collapse:collapse; font-size:12px; min-width:600px}
.kpi-table-item th{position:sticky; top:0; background:var(--panel); text-align:left; padding:8px; border-bottom:1px solid var(--border)}
.kpi-table-item td{padding:6px 8px; border-bottom:1px solid var(--border)}

/* ================================================= */
/* ===== ALTURAS UNIFICADAS DE KPI (por CSS) ======= */
/* ================================================= */
.kpi-card canvas{display:block; height:var(--kpi-h-small) !important}
.kpi-chart-wrapper canvas{display:block; height:var(--kpi-h-small) !important}
.resumen-grid .kpi-card[data-role="bar"] canvas,
.kpi-chart-wrapper[data-role="bar"] canvas{height:var(--kpi-h-bar) !important}
.kpi-card .table-wrap,
.kpi-table-item .table-wrap{max-height:var(--kpi-h-table); overflow:auto}

/* ================================================= */
/* ===== AJUSTES RESPONSIVOS ===== */
/* ================================================= */
@media (max-width:1280px){
  .resumen-grid{
    grid-template-columns:repeat(2, 1fr);
    grid-template-areas:
      "riesgo  categoria"
      "total   total"
      "heatmap heatmap"
      "unidad  unidad"
      "mapa    mapa"
      "fecha   fecha"
      "mes     mes";
  }
  .kpi-layout{grid-template-columns:1fr}
  .kpi-sidebar{order:-1; display:grid; grid-template-columns:1fr 1fr}
  .kpi-tables-wrapper{grid-template-columns:1fr}
}
@media (max-width:768px){
  .resumen-grid{
    grid-template-columns:1fr;
    grid-template-areas:
      "riesgo"
      "categoria"
      "total"
      "heatmap"
      "unidad"
      "mapa"
      "fecha"
      "mes";
  }
  .kpi-sidebar{grid-template-columns:1fr}
  .page-head{flex-direction:column; align-items:flex-start; gap:10px}
  .grid-2{grid-template-columns:1fr}
  .filter-bar{grid-template-columns:1fr}
}
@media (max-width:1023px){
  .app{flex-direction:column; display:block}
  .sidebar{position:fixed; transform:translateX(-100%)}
  .sidebar.show{transform:translateX(0)}
  .burger{display:none}
  .menu-toggle{display:grid}
}
@media (min-width:1024px){.menu-toggle{display:none}}

/* ===== FIX: scrollbars y sizing de charts ===== */
.views, .kpi-subviews-container{scrollbar-gutter:stable both-edges; overscroll-behavior:contain}
.kpi-card, .kpi-chart-wrapper{overflow:hidden}
.views{contain:layout size}
.view:not(.shown){display:none !important}
#view-kpi.shown{display:flex}

/* ================================================= */
/* ==== ACCESO PEATONAL – DISEÑO MODERNO MEJORADO ==== */
/* ================================================= */
#kpi-acceso-peatonal .ap-filters.ap-filters--row{
  display:grid;
  grid-template-columns:1.2fr 1.2fr 1fr 1.4fr auto;
  gap:14px; align-items:end; margin-bottom:18px;
  background:linear-gradient(135deg, #f8fbff 0%, #f0f7ff 100%);
  padding:18px; border-radius:16px; border:1px solid rgba(59,130,246,0.15);
  box-shadow:0 2px 8px rgba(59,130,246,0.08);
}
#kpi-acceso-peatonal .ap-filters.ap-filters--row label{
  display:flex; flex-direction:column; gap:8px; font-weight:600; color:#2d3748;
}

#kpi-acceso-peatonal .ap-filters.ap-filters--row select,
#kpi-acceso-peatonal .ap-filters.ap-filters--row input{
  border:2px solid rgba(59,130,246,0.2);
  border-radius:10px;
  padding:10px 12px;
  background:#fff;
  transition:all 0.3s ease;
}

#kpi-acceso-peatonal .ap-filters.ap-filters--row select:focus,
#kpi-acceso-peatonal .ap-filters.ap-filters--row input:focus{
  outline:none;
  border-color:#3b82f6;
  box-shadow:0 0 0 4px rgba(59,130,246,0.1);
}

#kpi-acceso-peatonal .ap-charts-grid-custom{
  display:grid;
  grid-template-columns:1fr;
  gap:16px;
  width:100%;
}

/* FILA 1: Línea (2fr) + Tarjetas (0.7fr) */
#kpi-acceso-peatonal .grid-row-1{
  display:grid;
  grid-template-columns:2fr 0.7fr;
  gap:12px;
  align-items:start;
}

/* FILA 2: Doughnut + Empresa (1fr each) */
#kpi-acceso-peatonal .grid-row-2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
  align-items:start;
}

/* FILA 3: Heatmap + Unidades (1fr each) */
#kpi-acceso-peatonal .grid-row-3{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
  align-items:start;
}

#kpi-acceso-peatonal .ap-stats-right{
  display:grid;
  grid-template-columns:1fr;
  gap:6px;
}

#kpi-acceso-peatonal .ap-stat-card{
  padding:10px 12px;
  border-radius:12px;
  background:#fff;
  border:1px solid #e2e8f0;
  display:flex;
  flex-direction:column;
  gap:4px;
  position:relative;
}

#kpi-acceso-peatonal .ap-stat-card .stat-value{
  font-size:18px;
  font-weight:800;
  color:#1f2937;
  line-height:1;
}

#kpi-acceso-peatonal .ap-stat-card .stat-label{
  font-size:9px;
  color:#6b7280;
  font-weight:600;
  text-transform:uppercase;
  letter-spacing:0.5px;
}

#kpi-acceso-peatonal .ap-stat-card .stat-icon{
  position:absolute;
  top:6px;
  right:8px;
  font-size:16px;
  opacity:0.2;
}

/* Gradientes para tarjetas */
#kpi-acceso-peatonal .ap-stat-primary{
  background:linear-gradient(135deg, rgba(59,130,246,0.05), rgba(59,130,246,0.02));
  border-color:rgba(59,130,246,0.2);
}

#kpi-acceso-peatonal .ap-stat-visit{
  background:linear-gradient(135deg, rgba(34,197,94,0.05), rgba(34,197,94,0.02));
  border-color:rgba(34,197,94,0.2);
}

#kpi-acceso-peatonal .ap-stat-provider{
  background:linear-gradient(135deg, rgba(59,130,246,0.05), rgba(59,130,246,0.02));
  border-color:rgba(59,130,246,0.2);
}

#kpi-acceso-peatonal .ap-stat-contractor{
  background:linear-gradient(135deg, rgba(168,85,247,0.05), rgba(168,85,247,0.02));
  border-color:rgba(168,85,247,0.2);
}

#kpi-acceso-peatonal .kpi-card{
  padding:20px; 
  border-radius:16px;
  background:#fff;
  border:1px solid #e2e8f0;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
  transition:all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  cursor:pointer;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

#kpi-acceso-peatonal .kpi-card canvas{
  flex-grow:1;
  min-height:0;
}

#kpi-acceso-peatonal .kpi-card::before{
  content:'';
  position:absolute;
  top:0; left:-100%; width:100%; height:100%;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  transition:left 0.6s ease;
  pointer-events:none;
}

#kpi-acceso-peatonal .kpi-card:hover::before{
  left:100%;
}

#kpi-acceso-peatonal .kpi-card:hover{
  transform:translateY(-6px) scale(1.01);
  box-shadow:0 16px 32px rgba(0,0,0,0.15);
  border-color:rgba(59,130,246,0.3);
}

#kpi-acceso-peatonal .kpi-card > h4{
  font-size:16px; margin:0 0 16px;
  color:#1f2937; font-weight:800;
  display:flex; align-items:center; gap:8px;
  letter-spacing:0.3px;
}

/* Alturas optimizadas para AP - Visibilidad completa */
#kpi-acceso-peatonal .ap-line canvas{ height:420px !important }
#kpi-acceso-peatonal .ap-donut canvas{ height:350px !important }
#kpi-acceso-peatonal .ap-by-company canvas{ height:300px !important }
#kpi-acceso-peatonal .ap-by-unit canvas{ height:350px !important }

#kpi-acceso-peatonal .ap-heatmap .table-wrap{
  flex-grow:1;
  max-height:280px;
  overflow:auto;
}

#kpi-acceso-peatonal .ap-stats{
  display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr)); grid-auto-rows:minmax(110px, auto); gap:16px; margin-top:20px;
}

#kpi-acceso-peatonal .ap-stat{
  padding:16px 14px; border-radius:14px; display:flex; flex-direction:column; justify-content:center; align-items:center;
  border:none; transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  font-weight:600;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
  cursor:pointer;
  position:relative;
  overflow:hidden;
}

#kpi-acceso-peatonal .ap-stat::before{
  content:'';
  position:absolute;
  top:0; left:0; right:0; bottom:0;
  background:linear-gradient(135deg, rgba(255,255,255,0.4) 0%, transparent 100%);
  pointer-events:none;
}

#kpi-acceso-peatonal .ap-stat:hover{
  transform:translateY(-4px);
  box-shadow:0 12px 24px rgba(0,0,0,0.15);
}

#kpi-acceso-peatonal .ap-stat__num{
  font-size:32px; line-height:1; font-weight:900; margin-bottom:8px; color:#fff;
  position:relative;
  z-index:1;
}

#kpi-acceso-peatonal .ap-stat__label{
  font-size:12px; opacity:.9; text-align:center; line-height:1.3; font-weight:600;
  position:relative;
  z-index:1;
  color:#fff;
}

/* Colores modernos con gradientes vibrantes */
#kpi-acceso-peatonal .ap-total{
  background:linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  box-shadow:0 4px 15px rgba(59,130,246,0.3);
}

#kpi-acceso-peatonal .ap-visita{
  background:linear-gradient(135deg, #10b981 0%, #059669 100%);
  box-shadow:0 4px 15px rgba(16,185,129,0.3);
}

#kpi-acceso-peatonal .ap-proveedor{
  background:linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  box-shadow:0 4px 15px rgba(245,158,11,0.3);
}

#kpi-acceso-peatonal .ap-contratista{
  background:linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  box-shadow:0 4px 15px rgba(139,92,246,0.3);
}

/* Leyendas/labels */
#kpi-acceso-peatonal .kpi-card .chart-legend,
#kpi-acceso-peatonal .kpi-card .legend,
#kpi-acceso-peatonal .kpi-card .labels{font-size:12px}

/* Responsive AP */
@media (max-width:1399px){
  #kpi-acceso-peatonal .grid-row-1{grid-template-columns:1fr 1fr}
  #kpi-acceso-peatonal .ap-filters.ap-filters--row{grid-template-columns:1fr 1fr 1fr 1fr auto}
}
@media (max-width:767px){
  #kpi-acceso-peatonal .ap-charts-grid-custom{grid-template-columns:1fr}
  #kpi-acceso-peatonal .grid-row-1{grid-template-columns:1fr}
  #kpi-acceso-peatonal .grid-row-2{grid-template-columns:1fr}
  #kpi-acceso-peatonal .grid-row-3{grid-template-columns:1fr}
  #kpi-acceso-peatonal .ap-filters.ap-filters--row{grid-template-columns:1fr}
  #kpi-acceso-peatonal .kpi-card canvas{height:220px !important}
}

/* Modal Editar Incidencia */
.modal-overlay{
  position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);
  display:none; align-items:center; justify-content:center; z-index:1000;
}

.modal-content{
  background:#fff; border-radius:12px; box-shadow:0 20px 60px rgba(0,0,0,0.3);
  padding:24px; position:relative;
}

.modal-header{
  display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; border-bottom:1px solid #eee; padding-bottom:16px;
}

.modal-header h2{
  margin:0; font-size:20px; color:#1f2937;
}

.btn-close-modal{
  background:none; border:none; font-size:24px; cursor:pointer; color:#999; padding:0; width:32px; height:32px; display:flex; align-items:center; justify-content:center; border-radius:6px; transition:all 0.2s;
}

.btn-close-modal:hover{
  background:#f0f0f0; color:#333;
}

.modal-form{
  display:flex; flex-direction:column; gap:16px;
}

.form-group{
  display:flex; flex-direction:column; gap:6px;
}

.form-group label{
  font-weight:600; font-size:13px; color:#374151;
}

.form-group input,
.form-group textarea,
.form-group select{
  padding:10px 12px; border:1px solid #ddd; border-radius:6px; font-size:13px; font-family:inherit;
  transition:all 0.2s;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus{
  outline:none; border-color:#2c5aa0; box-shadow:0 0 0 3px rgba(44,90,160,0.1);
}

.form-row{
  display:grid; grid-template-columns:1fr 1fr; gap:16px;
}

.modal-footer{
  display:flex; justify-content:flex-end; gap:12px; margin-top:24px; padding-top:16px; border-top:1px solid #eee;
}

.modal-footer .btn{
  padding:10px 20px; border:none; border-radius:6px; font-size:13px; font-weight:600; cursor:pointer; transition:all 0.2s;
}

.modal-footer .btn:hover{
  opacity:0.9; transform:translateY(-1px); box-shadow:0 4px 12px rgba(0,0,0,0.15);
}

@media (max-width:768px){
  .modal-content{
    width:95%; max-height:95vh;
  }
  .form-row{
    grid-template-columns:1fr;
  }
}

/* ================================================= */
/* ===== DETALLE ACCESO DASHBOARD ===== */
/* ================================================= */
.da-container{
  display:flex; flex-direction:column; gap:24px; padding:20px;
  background:var(--bg); min-height:100%;
  overflow-y:auto;
}

.da-filters{
  display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px;
  background:var(--panel); padding:20px; border-radius:var(--rad);
  border:1px solid var(--border); box-shadow:var(--shadow);
  align-items:flex-end;
}

.da-filter-group{
  display:flex; flex-direction:column; gap:6px;
}

.da-filter-group label{
  font-size:12px; font-weight:600; color:var(--muted); text-transform:uppercase;
  letter-spacing:0.3px;
}

.da-filter-group input,
.da-filter-group select{
  padding:10px 12px; border:1px solid var(--border); border-radius:6px;
  background:var(--bg); color:var(--fg); font-size:13px;
  transition:all 0.2s ease;
}

.da-filter-group input:focus,
.da-filter-group select:focus{
  outline:none; border-color:var(--brand); box-shadow:0 0 0 3px rgba(59, 130, 246, 0.1);
}

.btn-apply, .btn-export{
  padding:10px 18px; border:none; border-radius:6px; font-weight:600; cursor:pointer;
  transition:all 0.2s ease; font-size:13px;
}

.btn-apply{
  background:var(--brand); color:#fff;
}

.btn-apply:hover{
  background:#2563eb; transform:translateY(-2px); box-shadow:0 4px 12px rgba(59, 130, 246, 0.4);
}

.btn-export{
  background:var(--ok); color:#fff;
}

.btn-export:hover{
  background:#16a34a; transform:translateY(-2px); box-shadow:0 4px 12px rgba(34, 197, 94, 0.4);
}

/* SUMMARY CARDS */
.da-summary-cards{
  display:grid; grid-template-columns:repeat(auto-fit, minmax(160px, 1fr)); gap:16px;
}

.summary-card{
  background:var(--panel); border-radius:var(--rad);
  padding:20px; box-shadow:var(--shadow);
  border-left:4px solid var(--border);
  transition:all 0.2s ease;
}

.summary-card:hover{
  transform:translateY(-4px); box-shadow:0 12px 24px rgba(0,0,0,0.1);
}

.summary-card.card-primary{
  border-left-color:var(--brand);
  background:linear-gradient(135deg, rgba(59,130,246,0.05), rgba(59,130,246,0.02));
}

.summary-card.card-visit{
  border-left-color:#3b82f6;
  background:linear-gradient(135deg, rgba(59,130,246,0.05), rgba(59,130,246,0.02));
}

.summary-card.card-provider{
  border-left-color:#f59e0b;
  background:linear-gradient(135deg, rgba(245,158,11,0.05), rgba(245,158,11,0.02));
}

.summary-card.card-contractor{
  border-left-color:#8b5cf6;
  background:linear-gradient(135deg, rgba(139,92,246,0.05), rgba(139,92,246,0.02));
}

.summary-card.card-employee{
  border-left-color:#ec4899;
  background:linear-gradient(135deg, rgba(236,72,153,0.05), rgba(236,72,153,0.02));
}

.card-value{
  font-size:28px; font-weight:700; color:var(--fg);
  line-height:1;
}

.card-label{
  font-size:12px; color:var(--muted); margin-top:8px;
  font-weight:500; text-transform:uppercase; letter-spacing:0.3px;
}

/* CHARTS GRID */
.da-charts-grid{
  display:grid; grid-template-columns:repeat(auto-fit, minmax(400px, 1fr));
  gap:20px;
}

.chart-container{
  background:var(--panel); border-radius:var(--rad);
  padding:20px; box-shadow:var(--shadow);
  border:1px solid var(--border);
  height:420px;
  position:relative;
}

.chart-container h4{
  margin:0 0 15px 0; font-size:15px; font-weight:700;
  color:var(--fg);
}

.chart-container canvas{
  max-height:calc(100% - 45px);
  width:100% !important;
}

.chart-full{
  grid-column:1 / -1;
}

.chart-half{
  grid-column:span 1;
}

@media (max-width:768px){
  .da-charts-grid{
    grid-template-columns:1fr;
  }
  .chart-full, .chart-half{
    grid-column:1 / -1;
  }
}

/* TABLE SECTION */
.da-table-section{
  background:var(--panel); border-radius:var(--rad);
  padding:20px; box-shadow:var(--shadow);
  border:1px solid var(--border);
}

.da-table-section h3{
  margin:0 0 16px 0; font-size:16px; font-weight:600;
  color:var(--fg);
}

.table-controls{
  display:flex; gap:12px; margin-bottom:16px;
  flex-wrap:wrap;
}

.search-input, .sort-select{
  padding:10px 12px; border:1px solid var(--border); border-radius:6px;
  background:var(--bg); color:var(--fg); font-size:13px;
  transition:all 0.2s ease;
}

.search-input{
  flex:1; min-width:200px;
}

.search-input:focus, .sort-select:focus{
  outline:none; border-color:var(--brand); box-shadow:0 0 0 3px rgba(59, 130, 246, 0.1);
}

.detail-table{
  width:100%; border-collapse:collapse;
  font-size:13px;
}

.detail-table thead{
  background:linear-gradient(to right, #f9fafb, #f3f4f6);
  border-bottom:2px solid var(--border);
}

.detail-table th{
  padding:12px 10px; text-align:left; font-weight:600;
  color:var(--muted); text-transform:uppercase; letter-spacing:0.2px;
  font-size:11px;
}

.detail-table tbody tr{
  border-bottom:1px solid var(--border);
  transition:all 0.15s ease;
}

.detail-table tbody tr:hover{
  background:rgba(59, 130, 246, 0.03);
}

.detail-table td{
  padding:12px 10px; color:var(--fg);
}

.detail-table tbody tr:last-child{
  border-bottom:none;
}

@media (max-width:768px){
  .da-filters{
    grid-template-columns:1fr;
  }
  .detail-table{
    font-size:12px;
  }
  .detail-table th, .detail-table td{
    padding:8px 6px;
  }
}

/* ================================================= */
/* ===== QR GENERATOR STYLES ===== */
/* ================================================= */
.qr-container{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:2rem;
  padding:2rem;
}

.qr-form-section,
.qr-list-section{
  background:var(--panel);
  border-radius:var(--rad);
  padding:1.5rem;
  box-shadow:var(--shadow);
}

.qr-form-section h3,
.qr-list-section h3{
  margin-top:0;
  margin-bottom:1.5rem;
  font-size:1.125rem;
  color:var(--fg);
  border-bottom:2px solid var(--brand);
  padding-bottom:0.75rem;
}

.qr-form{
  display:flex;
  flex-direction:column;
  gap:1rem;
}

.form-group{
  display:flex;
  flex-direction:column;
  gap:0.5rem;
}

.form-group label{
  font-weight:600;
  color:var(--fg);
  font-size:0.9rem;
}

.required{
  color:var(--err);
}

.form-group input,
.form-group select{
  padding:0.75rem;
  border:1px solid var(--border);
  border-radius:6px;
  font-size:0.95rem;
  font-family:inherit;
  transition:all 0.2s;
}

.form-group input:focus,
.form-group select:focus{
  outline:none;
  border-color:var(--brand);
  box-shadow:0 0 0 3px rgba(59,130,246,0.1);
}

.geo-input-group{
  display:flex;
  gap:0.5rem;
  align-items:flex-end;
}

.geo-input-group input{
  flex:1;
  padding:0.75rem;
  border:1px solid var(--border);
  border-radius:6px;
  font-size:0.9rem;
}

.geo-input-group .btn{
  padding:0.75rem 1rem;
  white-space:nowrap;
}

.form-actions{
  display:flex;
  gap:0.75rem;
  margin-top:1rem;
}

.form-actions .btn{
  flex:1;
}

.qr-section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}

.qr-section-header h3 {
  margin: 0;
  font-size: 1.125rem;
  color: var(--fg);
  border-bottom: 2px solid var(--brand);
  padding-bottom: 0.75rem;
  flex: 1;
}

.qr-section-header .btn {
  margin-left: 1rem;
  white-space: nowrap;
}

.qr-filters {
  display: flex;
  gap: 0.75rem;
  margin-bottom: 1.5rem;
  padding: 1rem;
  background: var(--bg);
  border-radius: 8px;
  align-items: center;
}

.filter-select {
  flex: 1;
  min-width: 150px;
  padding: 0.75rem;
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 0.95rem;
  background: white;
  color: var(--fg);
  cursor: pointer;
}

.filter-select:focus {
  outline: none;
  border-color: var(--brand);
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.qr-filters .btn {
  padding: 0.75rem 1rem;
  white-space: nowrap;
}

.qr-list-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:1.5rem;
  max-height:600px;
  overflow-y:auto;
  padding-right:0.5rem;
}

.qr-list-grid::-webkit-scrollbar{
  width:6px;
}

.qr-list-grid::-webkit-scrollbar-track{
  background:transparent;
}

.qr-list-grid::-webkit-scrollbar-thumb{
  background:var(--border);
  border-radius:3px;
}

.qr-list-grid::-webkit-scrollbar-thumb:hover{
  background:var(--muted);
}

.qr-item{
  background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius:8px;
  padding:1rem;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:0.75rem;
  position:relative;
  overflow:hidden;
  box-shadow:0 4px 12px rgba(102,126,234,0.3);
  transition:transform 0.2s, box-shadow 0.2s;
}

.qr-item:hover{
  transform:translateY(-4px);
  box-shadow:0 6px 16px rgba(102,126,234,0.4);
}

.qr-item-canvas{
  background:white;
  padding:0.5rem;
  border-radius:4px;
  width:160px;
  height:160px;
}

.qr-item-canvas canvas{
  width:100% !important;
  height:100% !important;
}

.qr-item-info{
  width:100%;
  text-align:center;
  color:white;
  font-size:0.85rem;
}

.qr-item-info strong{
  display:block;
  font-size:0.9rem;
  margin-bottom:0.25rem;
  word-break:break-word;
}

.qr-item-info small{
  display:block;
  font-size:0.75rem;
  opacity:0.9;
}

.qr-item-actions{
  display:flex;
  gap:0.5rem;
  width:100%;
}

.qr-item-actions button{
  flex:1;
  padding:0.5rem;
  border:none;
  border-radius:4px;
  font-size:0.8rem;
  cursor:pointer;
  font-weight:600;
  transition:all 0.2s;
}

.qr-item-actions .btn-descargar{
  background:rgba(255,255,255,0.2);
  color:white;
  border:1px solid rgba(255,255,255,0.4);
}

.qr-item-actions .btn-descargar:hover{
  background:rgba(255,255,255,0.3);
  border-color:white;
}

.qr-item-actions .btn-eliminar{
  background:rgba(255,59,48,0.8);
  color:white;
}

.qr-item-actions .btn-eliminar:hover{
  background:rgba(255,59,48,1);
}

.qr-empty-state{
  grid-column:1/-1;
  padding:3rem 1rem;
  text-align:center;
  color:var(--muted);
}

.qr-empty-state strong{
  display:block;
  font-size:1.125rem;
  margin-bottom:0.5rem;
  color:var(--fg);
}

@media (max-width:1200px){
  .qr-container{
    grid-template-columns:1fr;
  }
}

@media (max-width:768px){
  .qr-container{
    padding:1rem;
    gap:1rem;
  }

  .qr-form-section,
  .qr-list-section{
    padding:1rem;
  }

  .qr-list-grid{
    grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
    max-height:400px;
  }

  .geo-input-group{
    flex-direction:column;
  }

  .geo-input-group .btn{
    width:100%;
  }
}

/* ===== MODAL DEL MAPA ===== */
.qr-map-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.qr-map-modal-content {
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  width: 90%;
  max-width: 700px;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.qr-map-header {
  padding: 1.5rem;
  border-bottom: 1px solid #e5e7eb;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.qr-map-header h3 {
  margin: 0;
  font-size: 1.25rem;
  color: #1f2937;
}

.qr-map-close {
  background: none;
  border: none;
  font-size: 1.75rem;
  color: #6b7280;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.qr-map-close:hover {
  color: #1f2937;
}

.qr-map-body {
  flex: 1;
  padding: 1.5rem;
  overflow-y: auto;
}

.qr-search-box {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.qr-search-box input {
  flex: 1;
  padding: 0.75rem;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 0.95rem;
}

.qr-search-box input:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.qr-search-box .btn {
  padding: 0.75rem 1.5rem;
  white-space: nowrap;
}

#qr-map-container {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.qr-map-info {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-top: 1rem;
}

.qr-map-info > div {
  display: flex;
  flex-direction: column;
}

.qr-map-info label {
  font-weight: 600;
  color: #374151;
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
}

.qr-map-info input {
  padding: 0.75rem;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 0.9rem;
  font-family: monospace;
  background: #f9fafb;
}

.qr-map-footer {
  padding: 1.5rem;
  border-top: 1px solid #e5e7eb;
  display: flex;
  gap: 0.75rem;
  justify-content: flex-end;
}

.qr-map-footer .btn {
  padding: 0.75rem 1.5rem;
}

/* Responsive */
@media (max-width: 640px) {
  .qr-map-modal-content {
    width: 95%;
    max-height: 95vh;
  }

  .qr-map-info {
    grid-template-columns: 1fr;
  }

  .qr-map-footer {
    flex-direction: column-reverse;
  }

  .qr-map-footer .btn {
    width: 100%;
  }
}

/* ================================================= */
/* ===== ESTILOS MODERNOS PARA CREAR QR Y RONDAS ===== */
/* ================================================= */

.modern-form-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 32px;
  padding: 28px;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  border-radius: 16px;
  min-height: 60vh;
}

.modern-form-section {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.modern-form-section h2 {
  font-size: 24px;
  font-weight: 700;
  color: #1a202c;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 10px;
}

.form-group {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 4px;
}

.form-group label {
  font-size: 13px;
  font-weight: 600;
  color: #4a5568;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  display: flex;
  align-items: center;
  gap: 4px;
}

.form-group input,
.form-group select,
.form-group textarea {
  padding: 12px 16px;
  border: 2px solid #e2e8f0;
  border-radius: 10px;
  font-size: 14px;
  background: white;
  color: #2d3748;
  transition: all 0.3s ease;
  font-family: inherit;
  width: 100%;
  box-sizing: border-box;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  background: #f8f9ff;
}

.form-group input::placeholder {
  color: #a0aec0;
}

.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.form-row-full {
  grid-column: 1 / -1;
}

.checkbox-group,
.radio-group {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
  padding: 16px;
  background: white;
  border-radius: 10px;
  border: 1px solid #e2e8f0;
}

.checkbox-item,
.radio-item {
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
  padding: 8px;
  border-radius: 8px;
  transition: all 0.2s ease;
}

.checkbox-item:hover,
.radio-item:hover {
  background: #f7fafc;
}

.checkbox-item input[type="checkbox"],
.checkbox-item input[type="radio"],
.radio-item input[type="radio"] {
  cursor: pointer;
  width: 18px;
  height: 18px;
  accent-color: #3b82f6;
}

.checkbox-item label,
.radio-item label {
  cursor: pointer;
  font-weight: 500;
  color: #2d3748;
  margin: 0;
}

.btn-group {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 20px;
}

.btn-modern {
  padding: 12px 24px;
  border: none;
  border-radius: 10px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
}

.btn-modern.primary {
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  color: white;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.btn-modern.primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(59, 130, 246, 0.5);
}

.btn-modern.secondary {
  background: white;
  color: #4a5568;
  border: 2px solid #e2e8f0;
}

.btn-modern.secondary:hover {
  background: #f7fafc;
  border-color: #cbd5e0;
}

.btn-modern.danger {
  background: #ef4444;
  color: white;
}

.btn-modern.danger:hover {
  background: #dc2626;
}

.btn-modern.success {
  background: #22c55e;
  color: white;
}

.btn-modern.success:hover {
  background: #16a34a;
}

/* Grid de items generados */
.items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 16px;
}

.item-card {
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  padding: 16px;
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.item-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #3b82f6, #8b5cf6);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.3s ease;
}

.item-card:hover {
  border-color: #3b82f6;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.item-card:hover::before {
  transform: scaleX(1);
}

.item-card h4 {
  margin: 0 0 8px 0;
  color: #1a202c;
  font-size: 16px;
  font-weight: 600;
}

.item-card p {
  margin: 4px 0;
  font-size: 12px;
  color: #718096;
}

.item-card-badge {
  display: inline-block;
  background: #eef2ff;
  color: #3b82f6;
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 600;
  margin-top: 8px;
}

/* Section de resultados */
.results-section {
  background: white;
  border-radius: 16px;
  padding: 24px;
  border: 1px solid #e2e8f0;
}

.results-section h3 {
  margin: 0 0 20px 0;
  font-size: 18px;
  font-weight: 700;
  color: #1a202c;
  display: flex;
  align-items: center;
  gap: 8px;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #718096;
}

.empty-state-icon {
  font-size: 48px;
  margin-bottom: 12px;
}

.empty-state p {
  margin: 0;
  font-size: 14px;
}

/* Card mejorado para rondas */
.ronda-card {
  background: white;
  border-left: 5px solid #3b82f6;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  width: 100%;
  max-width: 100%;
}

.ronda-card::after {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 200px;
  height: 200px;
  background: radial-gradient(circle, rgba(59, 130, 246, 0.05), transparent);
  border-radius: 50%;
  pointer-events: none;
}

.ronda-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
}

.ronda-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
  position: relative;
  z-index: 1;
  flex-wrap: wrap;
  gap: 8px;
}

.ronda-card-title {
  font-size: 18px;
  font-weight: 700;
  color: #1a202c;
  margin: 0;
  flex: 1;
  min-width: 200px;
}

.ronda-card-badge {
  display: inline-block;
  background: #dcfce7;
  color: #16a34a;
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  flex-shrink: 0;
}

.ronda-card-meta {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
  margin: 12px 0;
  position: relative;
  z-index: 1;
}

.meta-item {
  background: #f8f9ff;
  padding: 10px;
  border-radius: 8px;
  border-left: 3px solid #3b82f6;
  word-break: break-word;
}

.meta-item-label {
  font-size: 11px;
  color: #718096;
  font-weight: 600;
  text-transform: uppercase;
}

.meta-item-value {
  font-size: 14px;
  color: #1a202c;
  font-weight: 600;
  margin-top: 4px;
  word-break: break-word;
}

.ronda-card-actions {
  display: flex;
  gap: 8px;
  margin-top: 16px;
  position: relative;
  z-index: 1;
  flex-wrap: wrap;
}

.ronda-card-actions button {
  flex: 1;
  min-width: 100px;
  padding: 8px 12px;
  border: none;
  border-radius: 8px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.ronda-card-actions .btn-edit {
  background: #dcfce7;
  color: #16a34a;
}

.ronda-card-actions .btn-edit:hover {
  background: #bbf7d0;
}

.ronda-card-actions .btn-delete {
  background: #fee2e2;
  color: #dc2626;
}

.ronda-card-actions .btn-delete:hover {
  background: #fecaca;
}

/* Responsivo para rondas */
@media (max-width: 768px) {
  .ronda-card {
    padding: 16px;
  }
  
  .ronda-card-title {
    font-size: 16px;
  }
  
  .ronda-card-meta {
    grid-template-columns: 1fr;
  }
  
  .ronda-card-actions {
    flex-direction: column;
  }
  
  .ronda-card-actions button {
    width: 100%;
  }
}

/* Cuando el sidebar está colapsado */
.sidebar.collapsed ~ .main {
  margin-left: 0;
  padding: 20px;
}

.sidebar.collapsed ~ .main #rondasListContainer {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 16px;
  width: 100%;
}

/* Responsive */
@media (max-width: 1024px) {
  .modern-form-container {
    grid-template-columns: 1fr;
  }
}

/* === ESTILOS PARA STEP HEADERS EN FORMULARIOS === */
.form-step-header {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(59, 130, 246, 0.04) 100%);
  padding: 14px 16px;
  border-radius: 12px;
  margin-bottom: 16px;
  border-left: 5px solid #3b82f6;
  border-top: 1px solid rgba(59, 130, 246, 0.15);
  border-right: 1px solid rgba(59, 130, 246, 0.1);
  border-bottom: 1px solid rgba(59, 130, 246, 0.1);
  display: flex;
  align-items: center;
  gap: 12px;
}

.form-step-badge {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  color: white;
  border-radius: 8px;
  font-weight: 700;
  font-size: 14px;
  flex-shrink: 0;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
}

.form-step-label {
  font-size: 11px;
  font-weight: 700;
  color: #3b82f6;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin: 0;
  line-height: 1.2;
}

.form-step-content {
  display: flex;
  flex-direction: column;
  gap: 14px;
}

@media (max-width: 768px) {
  .modern-form-container {
    padding: 16px;
    gap: 20px;
  }

  .form-row {
    grid-template-columns: 1fr;
  }

  .checkbox-group {
    grid-template-columns: 1fr;
  }

  .btn-group {
    flex-direction: column;
  }

  .btn-modern {
    width: 100%;
    justify-content: center;
  }

  .items-grid {
    grid-template-columns: 1fr;
  }
}




/* ================================================= */
/* ===== ESTILOS MEJORADOS PARA FILTROS KPI ===== */
/* ================================================= */

/* Filtros mejorados - Ronda General y Detalle */
.kpi-subview input[type="text"][placeholder*="Seleccionar"],
.kpi-subview input[type="date"],
.kpi-subview select {
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.kpi-subview input[type="text"][placeholder*="Seleccionar"]:focus,
.kpi-subview input[type="date"]:focus,
.kpi-subview select:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59,130,246,0.1), 0 2px 8px rgba(59,130,246,0.15);
  background-color: #f0f4ff;
}

/* Mejorar botones de filtros */
#kpi-ronda-aplicar,
#kpi-ronda-limpiar,
#detalle-rondas-aplicar,
#detalle-rondas-limpiar,
#detalle-rondas-exportar {
  transition: all 0.3s ease;
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 0.3px;
  border: none;
  cursor: pointer;
  border-radius: 8px;
  padding: 10px 14px;
}

#kpi-ronda-aplicar,
#detalle-rondas-aplicar {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  color: white;
  box-shadow: 0 4px 12px rgba(59,130,246,0.3);
}

#kpi-ronda-aplicar:hover,
#detalle-rondas-aplicar:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(59,130,246,0.4);
  background: linear-gradient(135deg, #2563eb, #1d4ed8);
}

#kpi-ronda-aplicar:active,
#detalle-rondas-aplicar:active {
  transform: translateY(0);
}

#kpi-ronda-limpiar,
#detalle-rondas-limpiar {
  background: #f7fafc;
  color: #4a5568;
  border: 1px solid #cbd5e0;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

#kpi-ronda-limpiar:hover,
#detalle-rondas-limpiar:hover {
  background: #edf2f7;
  border-color: #a0aec0;
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.08);
}

#detalle-rondas-exportar {
  background: linear-gradient(135deg, #10b981, #059669);
  color: white;
  box-shadow: 0 4px 12px rgba(16,185,129,0.3);
}

#detalle-rondas-exportar:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(16,185,129,0.4);
  background: linear-gradient(135deg, #059669, #047857);
}

#detalle-rondas-exportar:active {
  transform: translateY(0);
}

/* Tarjeta de información mejorada */
#kpi-ronda-total,
#detalle-rondas-total {
  background: linear-gradient(135deg, #3b82f6, #2563eb);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: pulse-number 2s ease-in-out infinite;
}

@keyframes pulse-number {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

/* Tabla mejorada */
.kpi-subview table {
  border-collapse: collapse;
  width: 100%;
}

.kpi-subview table thead tr {
  background: linear-gradient(135deg, #f7fafc, #edf2f7);
  border-bottom: 2px solid #e2e8f0;
}

.kpi-subview table thead th {
  padding: 12px;
  text-align: left;
  font-weight: 700;
  color: #2d3748;
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border-right: 1px solid #e2e8f0;
}

.kpi-subview table tbody tr {
  border-bottom: 1px solid #e2e8f0;
  transition: background-color 0.2s ease;
}

.kpi-subview table tbody tr:hover {
  background-color: #f7fafc;
}

.kpi-subview table tbody td {
  padding: 12px;
  font-size: 12px;
  border-right: 1px solid #e2e8f0;
  color: #4a5568;
}

.kpi-subview table tbody td:last-child {
  border-right: none;
}

/* Badge de estado mejorado */
.estado-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 6px;
  font-weight: 600;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.estado-badge.terminada {
  background-color: #22c55e20;
  color: #22c55e;
}

.estado-badge.incompletada {
  background-color: #f59e0b20;
  color: #f59e0b;
}

.estado-badge.no-realizada {
  background-color: #ef444420;
  color: #ef4444;
}

/* ===== BOTÓN DE DESCARGA PDF ===== */
.btn-download-pdf {
  background: none;
  border: none;
  cursor: pointer;
  color: #3b82f6;
  font-size: 18px;
  padding: 4px;
  transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: 6px;
  position: relative;
  overflow: hidden;
}

.btn-download-pdf::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.1), transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.btn-download-pdf:hover {
  background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05));
  transform: scale(1.12) translateY(-2px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.btn-download-pdf:hover::before {
  opacity: 1;
}

.btn-download-pdf:active {
  transform: scale(0.95) translateY(0);
  box-shadow: 0 2px 4px rgba(59, 130, 246, 0.15);
}

/* Animación de descarga */
@keyframes download-pulse {
  0% { transform: translateY(-4px); opacity: 0; }
  50% { opacity: 1; }
  100% { transform: translateY(4px); opacity: 0; }
}

.btn-download-pdf.downloading {
  animation: download-pulse 0.6s ease-in-out;
  color: #10b981;
}

/* ===== RESPONSIVE: MOBILE ===== */
@media (max-width: 768px) {
  .topbar-right {
    gap: 12px;
  }

  .logo-empresa-topbar {
    height: 36px;
    padding: 3px 10px;
    border-radius: 8px;
  }

  .logo-empresa-img-topbar {
    height: 28px;
    max-width: 90px;
  }
}

@media (max-width: 480px) {
  .topbar {
    padding: 10px 12px;
  }

  .title {
    font-size: 16px;
  }

  .topbar-right {
    gap: 8px;
  }

  .logo-empresa-topbar {
    height: 32px;
    padding: 2px 8px;
    border-radius: 6px;
  }

  .logo-empresa-img-topbar {
    height: 24px;
    max-width: 80px;
  }

  .userpill {
    padding: 6px 10px;
    gap: 8px;
  }

  .avatar {
    width: 24px;
    height: 24px;
    font-size: 12px;
  }

  .userinfo {
    font-size: 12px;
  }
}

/* ================================================= */
/* ===== ESTILOS PARA INCIDENCIA QR (IQR) ===== */
/* ================================================= */

#iqr-tbody tr {
  border-bottom: 1px solid #e2e8f0;
  transition: all 0.3s ease;
}

#iqr-tbody tr:hover {
  background-color: #f7fafc;
  box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
}

#iqr-tbody td {
  padding: 12px;
  border-right: 1px solid #e2e8f0;
  vertical-align: middle;
  max-width: 200px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

#iqr-tbody td:last-child {
  border-right: none;
}

.iqr-estado-completado {
  color: #10b981;
  font-weight: 600;
  padding: 4px 12px;
  background-color: #d1fae5;
  border-radius: 6px;
  display: inline-block;
}

.iqr-estado-pendiente {
  color: #f59e0b;
  font-weight: 600;
  padding: 4px 12px;
  background-color: #fef3c7;
  border-radius: 6px;
  display: inline-block;
}

.iqr-badge {
  display: inline-block;
  padding: 4px 8px;
  background-color: #e0e7ff;
  color: #3730a3;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
}

.iqr-foto-cell {
  text-align: center;
}

.iqr-foto-cell img {
  max-width: 40px;
  max-height: 40px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.iqr-foto-cell img:hover {
  transform: scale(1.2);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}


